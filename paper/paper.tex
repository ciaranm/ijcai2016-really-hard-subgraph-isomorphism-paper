% vim: set spell spelllang=en tw=100 :

\documentclass[letterpaper]{article}
\usepackage[pass]{geometry}

\usepackage{ijcai13}
\usepackage{times}
\usepackage{complexity}
\usepackage{microtype}
\usepackage{gnuplot-lua-tikz}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{placeins}
\usepackage{cleveref}

% \usepackage{showframe}

\title{Really Hard Instances for the Subgraph Isomorphism Problem}
\author{Ciaran McCreesh\thanks{This work was supported by the Engineering and Physical Sciences
    Research Council [grant number EP/K503058/1]} \and Patrick Prossser \and James Trimble \\
University of Glasgow, Glasgow, Scotland \\
c.mccreesh.1@research.gla.ac.uk}

\begin{document}

\maketitle

\begin{abstract}
    Really hard SIP instances. Phase transitions. Alternative models and reduction.
\end{abstract}

\section{Introduction}

The \emph{non-induced subgraph isomorphism problem} is to find an injective mapping from a given
pattern graph to a given target graph which preserves adjacency---in essence, we are ``finding a
copy of'' the pattern inside the target. The \emph{induced} variant of the problem additionally
requires that the mapping preserve non-adjacency, so there are no ``extra edges'' in the copy of the
pattern that we find. Despite these problems being \NP-complete, modern practical subgraph
isomorphism algorithms can handle problem instances with many hundreds of vertices in the pattern
graph, and up to ten thousand vertices in the target graph
\cite{Cordella:2004,Solnon:2010,Audemard:2014,McCreesh:2015}.

However, these algorithms cannot handle \emph{arbitrary} instances of this size. The experimental
evaluations in these papers were performed using a mix of real-world instances (from applications
??), and randomly generated graph pairs. Using random instances can be beneficial, because it
provides a way of generating arbitrarily many instances cheaply, and reduces the risk of
over-fitting when tuning design parameters. The instances used were generated by taking a subgraph
of a random graph (using various models, including scale-free and bounded degree) and permuting the
vertices.  This is not ideal: such instances are guaranteed to be satisfiable, and so existing
benchmark suites contain relatively few non-trivial unsatisfiable instances. This introduces a new
source of bias when designing algorithms.

However, generating non-trivial unsatisfiable random instances is not straightforward. Using a
pattern graph from one of the random suites with the ``wrong'' target graph tends to give either a
trivially unsatisfiable instance, or a satisfiable instance. In particular, it is \emph{not} the
case that a relatively small random graph is very unlikely to appear in a larger random graph.

Here we present and evaluate a new method for creating random pattern/target pairs which can
generate both satisfiable and unsatisfiable instances. Our work builds upon the widely studied phase
transition phenomena observed in satisfiability and graph colouring problems. However, we have three
control parameters rather than one: we can independently alter the density of the pattern graph, the
density of the target graph, and the relative orders (number of vertices) of the pattern and target
graphs.  For non-induced isomorphisms, with the correct choice of parameters there is a phase
transition from satisfiable to unsatisfiable, and as expected we see a complexity peak occur (with
three different solvers) near this phase transition.

For certain choices of parameter for induced isomorphisms, there are two phase transitions, going
from satisfiable to unsatisfiable, and then from unsatisfiable back to satisfiable. Again, when
going from satisfiable to unsatisfiable (from either direction), instances go from being trivial to
really hard to solve. However, each of the three solvers we tested also finds the central
unsatisfiable region to be really hard---this is surprising, since this region is apparently
over-constrained. To show that this is not a simple weakness of subgraph isomorphism algorithms, we
show that the same behaviour occurs when using use a SAT solver, a pseudo-boolean solver, and a
clique encoding.

\subsection{Definitions}

?? Some stuff about order, density, random

\subsection{Experimental Setup}

?? experimental setup.

\section{Non-Induced Subgraph Isomorphisms}

\begin{figure}[h]
    \input{gen-graph-non-induced.tex}
    \setlength{\abovecaptionskip}{-1.5em}
    \caption{Behaviour of algorithms on the non-induced variant. Each point is the average of ten
        runs. For each plot, the x-axis is the pattern density and the y-axis is the target
        density, both from 0 to 1. Along the top row, we show the proportion of instances which are
        satisfiable; the white bands shows the phase transitions. On the second row, we show the
        number of search nodes used by the Glasgow algorithm, and on the third row, the number of
        search nodes used by the VF2 algorithm: the dark regions indicate ``really hard''
        instances.}
    \label{figure:non-induced}
\end{figure}

In the top row of \cref{figure:non-induced} we show the phase transition for the non-induced
variant, for patterns of order 10, 20 and 30, a target of order 150, and varying pattern (x-axis)
and target (y-axis) densities. Inside the orange region, at the bottom right of each plot, every
instance is unsatisfiable---here we are trying to find a dense pattern in a sparse target. In the
purple region, at the top left, every instance is satisfiable---we are looking for a sparse pattern
in a dense target (which is easy, since we only have to preserve adjacency, not non-adjacency). The
white band between the regions shows the location of the phase transition: here, roughly half the
instances are satisfiable.

On subsequent rows, we show the average difficulty of different algorithms.

We measure search nodes. Cannot be used to compare performance of algorithms directly, but this does
show that each solver found the same set of instances difficult.

Satisfiable is easy, until very close to the phase transition. Unsatisfiable is much harder than
satisfiable.

?? Are unsatisfiable instances on the phase transition much harder than satisfiable ones?

\subsection{Locating the Phase Transition}

\section{Induced Isomorphisms}

\begin{figure*}
    \input{gen-graph-induced.tex}
    \setlength{\abovecaptionskip}{-2em}
    \caption{Behaviour of algorithms on the induced variant. Each point is the average of ten
        runs. For each plot, the x-axis is the pattern density and the y-axis is the target
        density, both from 0 to 1. Along the top row, we show the proportion of instances which are
        satisfiable; the white bands shows the phase transitions. On the second row, we show the
        number of search nodes used by the Glasgow algorithm, and on the third row, the number of
        search nodes used by the VF2 algorithm: the dark regions indicate ``really hard''
        instances.}\label{figure:induced}
\end{figure*}

\subsection{Predicting Induced Behaviour}

?? Graph showing the product of satisfiable with vertical flip, min (unsat) and max (sat) of search
nodes with vertical flip.

\section{Other Encodings and Solvers}

\begin{figure*}
    \hskip-1.2cm\input{gen-graph-sat.tex}
    \setlength{\abovecaptionskip}{-2em}
    \caption{Behaviour of other solvers on the induced variant on smaller graphs, shown in the style of
        \cref{figure:induced}. The second row shows the number of search nodes used by the Glasgow
        algorithm, the third row shows the number of decisions made by the Glucose SAT solver, and
        the third row shows the number of search nodes used by a clique encoding.}
\end{figure*}

?? \cite{Anton:2009}

?? \cite{Lipets:2009}

\section{Conclusion}

\bibliographystyle{named}
\bibliography{paper}

\end{document}
